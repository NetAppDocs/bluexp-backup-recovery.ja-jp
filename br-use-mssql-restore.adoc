---
sidebar: sidebar 
permalink: br-use-mssql-restore.html 
keywords: backing up, restoring, back up, backup, restore, cloud volumes ontap, aws, azure, s3, blob, google cloud, storagegrid, back up volumes, cloud backup, restore volumes, cost, on-premises ontap, onprem, applications, virtual machines, backup and recovery 
summary: スナップショット コピー、セカンダリ ストレージに複製されたワークロード バックアップ、またはオブジェクト ストレージに保存されたバックアップからデータベース ワークロードを復元します。 
---
= BlueXP backup and recoveryで Microsoft SQL Server のワークロードを復元します
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
BlueXP backup and recoveryを使用して、スナップショットコピー、セカンダリストレージに複製されたワークロードバックアップ、またはオブジェクトストレージに保存されたバックアップから、Microsoft SQL Serverワークロードを復元します。ワークロードは、元の作業環境、同じクラウドアカウントを使用している別の作業環境、またはオンプレミスのONTAPシステムに復元できます。

.これらの場所から復元
異なる開始場所からワークロードを復元できます。

* プライマリロケーションから復元
* 複製されたリソースから復元する
* オブジェクトストアのバックアップから復元する


.これらのポイントに復元する
データを最新のスナップショットまたは以下のポイントに復元できます。

* スナップショットからの復元
* 特定の時点に復元します。ファイルの名前と場所、そして最後に正常な状態だった日付がわかっている場合に役立ちます。
* 最新のバックアップに復元する


.オブジェクトストレージからの復元に関する考慮事項
オブジェクトストレージ内のバックアップファイルを選択し、そのバックアップに対してランサムウェア保護が有効になっている場合（バックアップポリシーでDataLockとランサムウェア保護を有効にしている場合）、データを復元する前に、バックアップファイルに対して追加の整合性チェックを実行するように求められます。スキャンを実行することをお勧めします。


TIP: バックアップ ファイルの内容にアクセスするには、クラウド プロバイダーから追加の送信コストが発生します。



== ワークロードの復元の仕組み

ワークロードを復元すると、次のことが起こります。

* バックアップ ファイルからワークロードを復元すると、 BlueXP backup and recoveryによって、バックアップのデータを使用して新しいリソースが作成されます。
* 複製されたワークロードからリストアする場合、ワークロードを元の作業環境またはオンプレミスのONTAPシステムにリストアできます。
+
image:diagram_browse_restore_volume-unified.png["リソースを復元するフローを示す図"]

* オブジェクト ストレージからバックアップを復元する場合、データを元の作業環境またはオンプレミスのONTAPシステムに復元できます。




== 復元方法

ワークロードは、以下のいずれかの方法で復元できます。通常は、復元のニーズに応じて、以下のいずれかの方法を選択してください。

* *復元ページから*: リソースを復元する必要があるものの、正確な名前や保存場所、または最後に正常な状態だった日付を覚えていない場合に、この方法を使用します。フィルターを使用してスナップショットを検索できます。
* *インベントリページから*：過去1週間または1ヶ月間の特定のリソースを復元する必要がある場合、リソースの名前と場所、そして最後に良好な状態だった日付がわかっている場合に使用します。リソースのリストを参照し、復元したいリソースを見つけます。


*必要なBlueXPロール* 組織管理者、フォルダーまたはプロジェクト管理者、バックアップおよびリカバリのスーパー管理者、バックアップおよびリカバリの復元管理者ロール。  https://docs.netapp.com/us-en/bluexp-setup-admin/reference-iam-predefined-roles.html["すべてのサービスに対するBlueXPのアクセスロールについて学ぶ"^] 。



== 復元オプションからワークロードデータを復元します

復元オプションを使用してデータベース ワークロードを復元します。

.手順
. BlueXP のバックアップと復元メニューから、「復元」を選択します。
+
image:screen-br-restore.png["復元ページを示すスクリーンショット。"]

. 復元したいデータベースを選択します。フィルターを使用して検索します。
. リストアオプションを選択します。
+
** スナップショットからの復元
** 特定の時点に復元します。ファイルの名前と場所、そして最後に正常な状態だった日付がわかっている場合に役立ちます。
** 最新のバックアップに復元する
+
image:screen-br-restore-options2.png["復元オプションを示すスクリーンショット。"]







=== スナップショットからワークロードを復元する

. 復元オプション ページから続行して、*スナップショットからの復元*を選択します。
+
スナップショットのリストが表示されます。

+
image:screen-br-restore-snapshots-snapshotlist.png["復元するスナップショットのリストを示すスクリーンショット"]

. リストアするSnapshotを選択します。
. 「 * 次へ * 」を選択します。
+
次に、宛先オプションが表示されます。

+
image:screen-br-restore-destination-original-location.png["復元先の詳細ページを示すスクリーンショット。"]

. 宛先の詳細ページで、次の情報を入力します。
+
** *復元先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所に復元する場合は、ホスト名とインスタンスを選択し、データベース名を入力し、スナップショットを復元する宛先パスを入力します。
** *復元前のオプション*:
+
*** *復元中に同じ名前のデータベースを上書きする*: 復元中、元のデータベース名は保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *復元前にトランザクション ログ バックアップを作成*: 復元操作の前にトランザクション ログ バックアップを作成します。****復元前のトランザクション ログ バックアップが失敗した場合は復元を終了*: トランザクション ログ バックアップが失敗した場合は復元操作を停止します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクションログの復元には使用できません。これにより、トランザクションログのバックアップが適用された後、データベースがオンラインに戻ります。
*** *非運用*ですが、追加のトランザクションログの復元に使用できます。復元操作後、トランザクションログのバックアップを復元する間、データベースを非運用状態に維持します。このオプションは、追加のトランザクションログを復元する場合に便利です。
*** *読み取り専用モード*で、追加のトランザクションログの復元に使用できます。データベースを読み取り専用モードで復元し、トランザクションログのバックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. [* Restore] を選択します。




=== 特定の時点に復元する

BlueXP backup and recoveryでは、ログと最新のスナップショットを使用して、データの特定時点の復元を作成します。

. 復元オプション ページから続行して、*特定の時点に復元*を選択します。
. 「 * 次へ * 」を選択します。
+
image:screen-br-restore-point-in-time.png["特定の時点への復元ページを示すスクリーンショット"]

. 特定の時点への復元ページで、次の情報を入力します。
+
** *データ復元の日時*: 復元するデータの正確な日時を入力します。この日時はMicrosoft SQL Serverデータベースホストから取得されます。


. [検索]*を選択します。
. 復元するスナップショットを選択します。
. 「 * 次へ * 」を選択します。
. 宛先の詳細ページで、次の情報を入力します。
+
** *復元先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所に復元する場合は、ホスト名とインスタンスを選択し、データベース名と復元先のパスを入力します。
** *復元前のオプション*:
+
*** *元のデータベース名を保持*: 復元中に、元のデータベース名が保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクションログの復元には使用できません。これにより、トランザクションログのバックアップが適用された後、データベースがオンラインに戻ります。
*** *非運用*ですが、追加のトランザクションログの復元に使用できます。復元操作後、トランザクションログのバックアップを復元する間、データベースを非運用状態に維持します。このオプションは、追加のトランザクションログを復元する場合に便利です。
*** *読み取り専用モード*で、追加のトランザクションログの復元に使用できます。データベースを読み取り専用モードで復元し、トランザクションログのバックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. [* Restore] を選択します。




=== 最新のバックアップに復元する

このオプションでは、最新の完全バックアップとログバックアップを使用して、データを最後の正常な状態に復元します。システムは、最後のスナップショットから現在までのログをスキャンします。このプロセスは、変更とアクティビティを追跡し、データの最新かつ正確なバージョンを復元します。

. 復元オプション ページから続行して、*最新のバックアップに復元* を選択します。
+
BlueXP backup and recoveryでは、復元操作に使用できるスナップショットが表示されます。

+
image:screen-br-restore-to-latest-state.png["最新の状態に復元するページのスクリーンショット"]

. 「最新の状態に復元」ページで、ローカル、セカンダリ ストレージ、またはオブジェクト ストレージのスナップショットの場所を選択します。
. 「 * 次へ * 」を選択します。
. 宛先の詳細ページで、次の情報を入力します。
+
** *復元先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所に復元する場合は、ホスト名とインスタンスを選択し、データベース名と復元先のパスを入力します。
** *復元前のオプション*:
+
*** *復元中に同じ名前のデータベースを上書きする*: 復元中、元のデータベース名は保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *復元前にトランザクション ログ バックアップを作成する*: 復元操作の前にトランザクション ログ バックアップを作成します。
*** *復元前のトランザクション ログ バックアップが失敗した場合は復元を終了*: トランザクション ログ バックアップが失敗した場合は復元操作を停止します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクションログの復元には使用できません。これにより、トランザクションログのバックアップが適用された後、データベースがオンラインに戻ります。
*** *非運用*ですが、追加のトランザクションログの復元に使用できます。復元操作後、トランザクションログのバックアップを復元する間、データベースを非運用状態に維持します。このオプションは、追加のトランザクションログを復元する場合に便利です。
*** *読み取り専用モード*で、追加のトランザクションログの復元に使用できます。データベースを読み取り専用モードで復元し、トランザクションログのバックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. [* Restore] を選択します。




== インベントリオプションからワークロードデータを復元する

「インベントリ」ページからデータベースワークロードを復元します。「インベントリ」オプションを使用すると、インスタンスではなくデータベースのみを復元できます。

.手順
. BlueXP のバックアップと復元メニューから、*インベントリ*を選択します。
. 復元するリソースが配置されているホストを選択します。
. *アクション*を選択しますimage:icon-action.png["アクションアイコン"]アイコンをクリックし、[詳細を表示] を選択します。
. Microsoft SQL Server ページで、*データベース* タブを選択します。
. [データベース] タブで、復元可能なバックアップがあることを示す「保護済み」ステータスが表示されているデータベースを選択します。
+
image:screen-br-restore-inventory-databases-tab.png["インベントリページとデータベースタブを示すスクリーンショット"]

. *アクション*を選択しますimage:icon-action.png["アクションアイコン"]アイコンをクリックし、[復元] を選択します。
+
復元ページから復元する場合と同じ 3 つのオプションが表示されます。

+
** スナップショットからの復元
** 特定の時点に復元する
** 最新のバックアップに復元する


. 復元ページから復元オプションについて同じ手順を続行します。
+
image:screen-br-restore-options2.png["復元オプションを示すスクリーンショット。"]



ifdef::aws[]

endif::aws[]

ifdef::azure[]

endif::azure[]

ifdef::gcp[]

endif::gcp[]

ifdef::aws[]

endif::aws[]

ifdef::azure[]

endif::azure[]

ifdef::gcp[]

endif::gcp[]
